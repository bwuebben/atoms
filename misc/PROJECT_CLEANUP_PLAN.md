# Project Cleanup Plan

**Generated:** 2026-01-01
**Status:** Needs attention

---

## Current Issues

### 1. README.md and CLAUDE.md are Outdated ❌

**Problem:**
- Both files only document ATOMS (original algorithm)
- No mention of S-ATOMS (the new implementation in `src/satoms/`)
- Users won't know about the enhanced S-ATOMS features

**Needs:**
- Update README.md to include S-ATOMS overview and quick start
- Update CLAUDE.md with S-ATOMS architecture and usage
- Clarify relationship between ATOMS and S-ATOMS

---

### 2. S-ATOMS Doesn't Load from data/processed/ ❌

**Problem:**
- `src/satoms/s_atoms_industry.py` generates synthetic data only
- `src/atoms/industry_portfolios.py` properly loads from `data/processed/`
- Inconsistent data loading behavior across modules

**Current:**
```python
# atoms/industry_portfolios.py - GOOD
def load_french_industry_portfolios(filepath=None):
    if filepath is None:
        default_path = 'data/processed/industry_returns.csv'
        if os.path.exists(default_path):
            return pd.read_csv(default_path, index_col=0, parse_dates=True)
    # ... fallback to synthetic
```

```python
# satoms/s_atoms_industry.py - BAD
def generate_regime_switching_industry_data(...):
    # Only generates synthetic data, doesn't check data/processed/
```

**Needs:**
- Add data loading functions to S-ATOMS that check `data/processed/` first
- Maintain synthetic fallback for when data isn't available
- Match the pattern used in ATOMS module

---

### 3. Module Documentation Missing ❌

**Current structure:**
```
src/
├── atoms/
│   ├── atoms.py               (no docstring header)
│   ├── atoms_r2.py            (no docstring header)
│   ├── example_regime_switching.py
│   ├── industry_portfolios.py
│   └── NO README.md
└── satoms/
    ├── s_atoms.py             (has module docstring ✓)
    ├── s_atoms_industry.py    (has module docstring ✓)
    ├── test_minimal.py
    ├── test_industry_fast.py
    ├── VERIFICATION_REPORT.md
    └── NO README.md
```

**Needs:**
- Create `src/atoms/README.md` explaining the ATOMS module
- Create `src/satoms/README.md` explaining the S-ATOMS module
- Each README should include:
  - Overview of algorithms
  - Quick start examples
  - File descriptions
  - Relationship to paper equations

---

### 4. Example Files Organization ⚠️

**Current:**
```
src/atoms/
├── example_regime_switching.py  ✓ Good demo
└── industry_portfolios.py       ✓ Full empirical analysis

src/satoms/
├── s_atoms_industry.py          ⚠️ Name suggests example, but it's huge (783 lines)
├── test_minimal.py              ✓ Good minimal test
└── test_industry_fast.py        ✓ Good fast test
```

**Observations:**
- ATOMS has clear example vs core separation
- S-ATOMS mixes test files with industry analysis
- `s_atoms_industry.py` is both:
  - A full industry analysis script (like atoms/industry_portfolios.py)
  - Contains data generation functions
  - Has a main() that runs analysis

**Recommendation:**
- Keep current structure but clarify naming/roles
- Consider: `s_atoms_industry.py` → `example_industry_portfolios.py`
- Or keep as is but document clearly

---

### 5. Project Structure Assessment ✅ MOSTLY GOOD

**Current:**
```
atoms/
├── data/
│   ├── processed/           ✓ Generated by download_data.py
│   └── raw/                 ✓ Downloaded data
├── docs/
│   ├── Doc__A_Atoms_Synthesis.tex  ✓ S-ATOMS paper
│   ├── Doc__A_Atoms_Synthesis.pdf  ✓ S-ATOMS paper PDF
│   └── ssrn-5980654.pdf            ✓ ATOMS paper
├── src/
│   ├── atoms/               ✓ Original ATOMS implementation
│   │   ├── atoms.py
│   │   ├── atoms_r2.py
│   │   ├── example_regime_switching.py
│   │   └── industry_portfolios.py
│   ├── satoms/              ✓ Enhanced S-ATOMS implementation
│   │   ├── s_atoms.py
│   │   ├── s_atoms_industry.py
│   │   ├── test_minimal.py
│   │   ├── test_industry_fast.py
│   │   └── VERIFICATION_REPORT.md
│   └── download_data.py     ⚠️ Should this be in root?
├── README.md                ❌ Only ATOMS
├── CLAUDE.md                ❌ Only ATOMS
└── requirements.txt         ✓ Good
```

**Assessment:**
- ✅ Clear separation: ATOMS vs S-ATOMS
- ✅ Coherent structure
- ⚠️ `download_data.py` location questionable (in src/ but top-level script)
- ❌ Missing module-level READMEs

**Relationship:**
- **ATOMS** (src/atoms/): Original paper by Capponi et al. 2025
  - Tournament model selection
  - Adaptive window via Goldenshluger-Lepski
  - Hard selection (winner-take-all)

- **S-ATOMS** (src/satoms/): Enhanced version by Wuebben 2025
  - Extends ATOMS with 3 innovations:
    1. Soft ensemble weighting (Section 3.2)
    2. Empirical proxy estimation via bootstrap (Section 3.1)
    3. Similarity-based data selection (Section 3.3)
  - Backward compatible (can disable features to get ATOMS)

---

## Recommended Actions

### Priority 1: Documentation

1. **Update README.md** to include:
   ```markdown
   # ATOMS & S-ATOMS: Adaptive Model Selection for Non-Stationary Environments

   ## Implementations

   This repository contains two related implementations:

   ### ATOMS (src/atoms/)
   Original algorithm from Capponi et al. (2025)...

   ### S-ATOMS (src/satoms/)
   Enhanced algorithm from Wuebben (2025)...
   ```

2. **Update CLAUDE.md** with S-ATOMS sections

3. **Create src/atoms/README.md**

4. **Create src/satoms/README.md**

### Priority 2: Data Loading

5. **Add data loading to S-ATOMS** following ATOMS pattern:
   ```python
   def load_industry_data(filepath=None):
       """Load industry returns, checking data/processed/ first."""
       if filepath is None:
           # Try data/processed/ first
           default_path = '../../data/processed/industry_returns.csv'
           if os.path.exists(default_path):
               return pd.read_csv(default_path, ...)
       # Fallback to synthetic
       return generate_regime_switching_industry_data(...)
   ```

### Priority 3: Optional Improvements

6. **Move download_data.py to root?**
   - Currently: `src/download_data.py`
   - Better: `download_data.py` (top level)
   - Or: `scripts/download_data.py`

7. **Add __init__.py files** to make modules importable:
   - `src/atoms/__init__.py`
   - `src/satoms/__init__.py`

---

## Questions for User

1. **Naming:** Should `s_atoms_industry.py` be renamed to `example_industry_portfolios.py` to match ATOMS naming?

2. **download_data.py:** Move to root or keep in src/?

3. **Module imports:** Do you want users to be able to `import atoms` or `import satoms` as packages? If yes, need __init__.py files.

4. **Documentation depth:** How detailed should module READMEs be? (Quick reference vs comprehensive guide)

---

## File Manifest

### Need to Create:
- [ ] Updated `README.md`
- [ ] Updated `CLAUDE.md`
- [ ] `src/atoms/README.md`
- [ ] `src/satoms/README.md`

### Need to Modify:
- [ ] `src/satoms/s_atoms_industry.py` (add data loading)

### Consider:
- [ ] `src/atoms/__init__.py` (optional)
- [ ] `src/satoms/__init__.py` (optional)
- [ ] Move `src/download_data.py` to root (optional)

---

## Next Steps

Shall I proceed with:
1. Updating README.md and CLAUDE.md?
2. Adding data loading to S-ATOMS?
3. Creating module READMEs?

Let me know your preferences on the questions above, and I'll implement the cleanup!
